{"mappings":"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","sources":["src/library.js","src/js/buttons.js"],"sourcesContent":["import './js/loader';\nimport './sass/index.scss';\nimport './js/api-key';\nimport './js/buttons';\n// import './js/pagination';\nimport './js/page-up';\nimport './js/array-of-genres';\nimport './js/footer-modal';\nimport './js/team-photo';\nimport './js/movie-modal-local-storage';\nimport './js/modal-open';\nimport './js/modal-close';\n","import { API_KEY } from './api-key';\nimport { arrayOfGenres } from './array-of-genres';\n\nconst baseURL = 'https://api.themoviedb.org/3/movie/';\n\nconst refs = {\n  btnQueue: document.querySelector('#queue'),\n  btnWatched: document.querySelector('#watched'),\n  text: document.querySelector('#text'),\n  filmList: document.querySelector('.film_list'),\n};\n\nrefs.btnQueue.addEventListener('click', onBtnQueue);\nrefs.btnWatched.addEventListener('click', onBtnWatched);\n\nconst fetchQueueFilms = async id => {\n  const response = await fetch(`${baseURL}${id}?api_key=${API_KEY}`);\n  const films = await response.json();\n  return films;\n};\n\nfunction onBtnQueue() {\n  // onLoader();\n  hideMessage();\n  refs.filmList.innerHTML = '';\n  try{\n    const savedQueueFilms = JSON.parse(localStorage.getItem('queue').split(','));\n    if(savedQueueFilms.length > 0){\n      savedQueueFilms.map(film =>\n        fetchQueueFilms(film).then(film => {\n          rendOneCard(film).then(r => {\n            refs.filmList.insertAdjacentHTML('beforeend', r);\n            // offLoader();\n          });\n        })\n      );\n    } else listIsEmpty()\n  } catch (error) {\n    listIsEmpty()\n  }\n}\n\nconst fetchWatchedFilms = async idw => {\n  const response = await fetch(\n    `https://api.themoviedb.org/3/movie/${idw}?api_key=${API_KEY}`\n  );\n  const films = await response.json();\n  return films;\n};\n\nfunction onBtnWatched() {\n  // onLoader();\n  hideMessage();\n  refs.filmList.innerHTML = '';\n  try{\n  const savedWatchedFilms = JSON.parse(localStorage.getItem('watched').split(','));\n  if(savedWatchedFilms.length > 0){\n    savedWatchedFilms.map(film =>\n      fetchWatchedFilms(film).then(film => {\n        rendOneCard(film).then(r => {\n          refs.filmList.insertAdjacentHTML('beforeend', r);\n          // offLoader();\n        });\n      })\n    );\n  } else listIsEmpty()\n  } catch (error){\n    listIsEmpty()\n  }\n}\n\nfunction listIsEmpty(){\n  refs.filmList.innerHTML = '<p class=\"library-message\">Sorry, list is empty(</p>';\n}\n\n//заховати повідомлення \"будь ласка, оберіть категорію\"\nfunction hideMessage(){\n  if(refs.text.classList.contains(\"library-message\")){\n    refs.text.classList.remove('library-message')\n    refs.text.classList.add('library-message-hidden')\n  }\n}\n\nfunction rendOneCard(film) {\n  const genres = decipherGenresIds(film);\n  const yearOfRelease = onYearOfFilm(film);\n  return patternOfCard(film, genres, yearOfRelease);\n}\n\nfunction decipherGenresIds(film) {\n  if (film.genres.length === 0) {\n    return 'Without genres';\n  }\n  return arrayOfGenres\n    .then(r => {\n      return r\n        .filter(genre => {\n          for (const id of film.genres) {\n            if (id.id === genre.id) {\n              return genre.name;\n            }\n          }\n        })\n        .map(genre => genre.name);\n    })\n    .then(r => {\n      if (r.length < 3) {\n        return r;\n      }\n      return [...[...r].slice(0, 2), ...['Other']];\n    });\n}\n\nfunction onYearOfFilm(film) {\n  const yearOfRelease = film.release_date.split('-');\n  return yearOfRelease;\n}\n\nasync function patternOfCard(film, genres, yearOfRelease) {\n  if (genres === 'Without genres') {\n    return `<li film-id=\"${film.id}\" class=\"film-list__item\">\n  <img\n    src=${posterLinkGenerate(film)}\n    alt=\"${film.title}\"\n    class=\"film-list__item-poster\"\n    film-id=\"${film.id}\"\n    loading=\"lazy\"\n  />\n  <div class=\"film-list__item-info\">\n    <h3 class=\"film-list__item-title\">${film.title}</h3>\n    <div class=\"film-list__item-details\">\n      <span class=\"film-list__item-genres\">${genres}</span>\n      <span class=\"film-list__item-strip\">|</span>\n      <span class=\"film-list__item-year\">${yearOfRelease[0]}</span>\n      <span class=\"film-list__item-rate\">&nbsp;${film.vote_average.toFixed(\n        1\n      )}&nbsp;</span>\n    </div>\n  </div>\n</li>`;\n  }\n  const asyncGenres = await genres.then(r => r);\n  return `<li film-id=\"${film.id}\" class=\"film-list__item\">\n  <img\n    src=${posterLinkGenerate(film)}\n    alt=\"${film.title}\"\n    class=\"film-list__item-poster\"\n    film-id=\"${film.id}\"\n    loading=\"lazy\"\n  />\n  <div class=\"film-list__item-info\">\n    <h3 class=\"film-list__item-title\">${film.title}</h3>\n    <div class=\"film-list__item-details\">\n      <span class=\"film-list__item-genres\">${asyncGenres.join(', ')}</span>\n      <span class=\"film-list__item-strip\">|</span>\n      <span class=\"film-list__item-year\">${yearOfRelease[0]}</span>\n      <span class=\"film-list__item-rate\">&nbsp;${film.vote_average.toFixed(\n        1\n      )}&nbsp;</span>\n    </div>\n  </div>\n</li>`;\n}\n\nfunction posterLinkGenerate(film) {\n  if (film.poster_path !== null) {\n    return `\"https://image.tmdb.org/t/p/w500${film.poster_path}\"`;\n  }\n  return `\"https://raw.githubusercontent.com/Alexandra-Makarenko/filmoteka-js-team-project/main/src/images/no-poster.jpg\"`;\n}\n"],"names":["parcelRequire","$bpxeT","$c07c620d873608c6$var$refs","btnQueue","document","querySelector","btnWatched","text","filmList","addEventListener","$c07c620d873608c6$var$hideMessage","innerHTML","savedQueueFilms","JSON","parse","localStorage","getItem","split","length","map","film1","$c07c620d873608c6$var$fetchQueueFilms","then","film","$c07c620d873608c6$var$rendOneCard","r","insertAdjacentHTML","$c07c620d873608c6$var$listIsEmpty","error","savedWatchedFilms","film2","$c07c620d873608c6$var$fetchWatchedFilms","$parcel$interopDefault","$2TvXO","mark","_callee","id","response","films","fetch","concat","$hM3Qt","API_KEY","_ctx","sent","json","idw","classList","contains","remove","add","genres","$2cELT","arrayOfGenres","filter","genre","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","name","err","return","$8nrFW","slice","$c07c620d873608c6$var$decipherGenresIds","yearOfRelease","release_date","$c07c620d873608c6$var$onYearOfFilm","$c07c620d873608c6$var$_patternOfCard","apply","this","arguments","$c07c620d873608c6$var$patternOfCard","asyncGenres","$c07c620d873608c6$var$posterLinkGenerate","title","vote_average","toFixed","join","poster_path"],"version":3,"file":"library.3585db7e.js.map"}